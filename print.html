<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Melodia - Ing. de Software II - FIUBA</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Inicio.html"><strong aria-hidden="true">1.</strong> Inicio</a></li><li class="chapter-item expanded "><a href="documentacion.html"><strong aria-hidden="true">2.</strong> Documentacion</a></li><li class="chapter-item expanded "><a href="manual.html"><strong aria-hidden="true">3.</strong> Manual de usuario</a></li><li class="chapter-item expanded "><a href="manual_admin.html"><strong aria-hidden="true">4.</strong> Manual de admin</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Melodia - Ing. de Software II - FIUBA</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="inicio"><a class="header" href="#inicio">Inicio</a></h1>
<p>Documentación del grupo 11 para el proyecto Melodia del 2do cuatrimestre 2025 de la materia Ingeniería de Software II - FIUBA</p>
<p>El equipo de desarrollo está conformado por:</p>
<ul>
<li>
<p><strong>Integrantes:</strong></p>
<ul>
<li>Paolo Belforte (109432)</li>
<li>Edgardo Francisco Sáez (104896)</li>
<li>Iñaki Pujato (109131)</li>
<li>Martín Reimundo (106716)</li>
<li>Mateo Lardiez (107992)</li>
</ul>
</li>
<li>
<p><strong>Corrector:</strong></p>
<ul>
<li>Rodrigo Echeconea</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="documentación"><a class="header" href="#documentación">Documentación</a></h1>
<p>Documentación de nuestra aplicación, junto con la arquitectura que la acompaña.</p>
<h2 id="arquitectura-general"><a class="header" href="#arquitectura-general">Arquitectura general</a></h2>
<p><img src="./arquitectura_back.png" alt="Arquitectura general" /></p>
<p>Nuestra aplicación corre en cloud utilizando los servicios de GCP (google cloud provider), como se puede ver en el diagrama, siempre que se intenta acceder a algun recurso es a traves de HTTP y debe pasar por el gateway. Este se encarga de las validaciones basicas verificando que tenga el token de acceso, y ruteando el request al servicio que corresponda.</p>
<p>Luego, contamos con 2 servicios propios y uno que utilizamos de firebase. Empezando por este último, es el encargado de manejar el inicio de sesion y los registros de los usuarios, ya que lo encontramos como la manera mas sencilla y eficiente de hacerlo.</p>
<p>Por otro lado, los 2 servicios que estuvimos implementando son:</p>
<p>Servicio de Library, maneja todo lo relacionado a canciones y albumes, es el core de la aplicación. Esta implementando en typescript y utiliza postgres y prisma como ORM, hosteado en prisma studio.</p>
<p>Servicio de Users, encargado de manejar artistas y usuarios de la aplicación y las relaciones entre ellos. Este utiliza javascript y mongoDB, hosteado en mongodbAtlas, para funcionar.</p>
<p>Por otro lado este mismo servicio tiene un endpoint particular que es utilizado por los demas servicios que es el de subir un archivo (ya sea de sonido o una imágen) a Google Cloud Storage, tomamos esta decisión por que no le vimos sentido a crear un microservicio para que solo tenga este endpoint, y tener repetido la lógica por ejemplo en el servicio de Users y en el de Library para que por ejemplo uno solo cargue sonidos y otro las imagenes, tampoco lo vimos muy util.</p>
<p>Para notar, tambien tenemos el monitoreo de nuestra aplicación utilizando pub/sub de google cloud, para que envie los logs a <a href="https://onenr.io/08jqkYmevwl">new relic y poder monitorearla</a>, y si se quiere buscar particularmente información de cada endpoint implementado, los repositorios de los servicios cuentan con sus respectivos archivos openapi.</p>
<h2 id="gateway"><a class="header" href="#gateway">Gateway</a></h2>
<p><a href="https://gateway-182190207837.europe-west1.run.app/">Acceso al gateway</a></p>
<h2 id="users-service"><a class="header" href="#users-service">Users service</a></h2>
<p>El servicio de usuarios se encarga de manejar las relaciones de usuarios y artistas, como puede ser su creación, seguir usuarios, guardar los generos favoritos y demas.</p>
<p>Esta implementado en su totalidad en JavaScript, utilizando NodeJs y express. Para el manejo de la base de datos utiliza MongoDB con la extensión de mongoose para simplificar las acciones. Por otro lado utiliza los paquetes de firebase para enviar las notificaciones hacia los usuarios.</p>
<p>El código esta separado en multiples clases, cada una con su responsabilidad, siendo estas</p>
<ul>
<li>Server. Inicializa todos los demas objetos y empieza a recibir las peticiones, ademas de declarar el middleware centralizado para manejar errores</li>
<li>Routers. Definen los endpoints que se estaran escuchando, llaman a las <code>actions</code> con los datos que le sean de interes y devuelven el resultado al front en formato json</li>
<li>Actions. Se encargan de sanitizar los datos inicialmente y llamar a los <code>services</code>, verificando el resultado de estas y lanzando errores en caso de ser necesarios.</li>
<li>Services. Tienen toda la lógica de negocio, reciben los datos limpios para utilizar que provienen del <code>action</code> que los invoco. Es la capa que tiene acceso a las <code>database</code>.</li>
<li>Database. Es la conexión con la base de datos, cuenta con primitivas básicas para mantener la mayor separación entre los servicios y el acceso a los datos.</li>
</ul>
<h2 id="library-service"><a class="header" href="#library-service">Library service</a></h2>
<p>Este microservicio gestiona la metadata y el ciclo de vida de las canciones, albumes y playlists: creación, lectura, actualización, borrado, bloqueo/desbloqueo por administración, conteo de reproducciones y consultas especializadas (filtrado por género/artist/fecha, apariciones, últimos lanzamientos). Ademas, lleva un registro de auditoria de las colecciones, en cada accion que realize cambios de estado sobre las mismas.</p>
<p>Está implementado en TypeScript sobre Node.js y Express. Usa Prisma como cliente de base de datos. La lógica está separada en capas para mantener responsabilidades claras y facilitar pruebas y mantenimiento.</p>
<h4 id="estructura"><a class="header" href="#estructura">Estructura</a></h4>
<ul>
<li>Server: Inicializa Express, middlewares globales (parsing, CORS, manejo de errores) y arranca el listener HTTP.</li>
<li>Routers: Rutas REST que exponen operaciones sobre canciones, albumes o playlists.</li>
<li>Controllers: Validan y sanitizan entradas (zod schemas), manejan códigos HTTP (HttpCodesEnum), delegan a los services y formatean respuestas JSON. También realizan validaciones simples (p. ej. verifyInt) y logging.</li>
<li>Services: Contienen la lógica de negocio y orquestan operaciones.</li>
<li>Repositorios: Acceso a datos a través de Prisma. Encapsulan consultas y mapeos a la persistencia.</li>
<li>Interfaces: Contienen los contratos TypeScript que definen las formas de datos compartidos entre capas (canciones, álbumes, auditoría y respuestas). Centralizan tipos para evitar duplicación y facilitar el intercambio seguro entre controllers, services y repositorios.</li>
<li>Tests: Permiten validar comportamiento de controllers/services/repositorios y asegurar integridad de la API contra la base de datos de prueba.</li>
</ul>
<h4 id="operaciones-destacadas"><a class="header" href="#operaciones-destacadas">Operaciones destacadas</a></h4>
<ul>
<li>CRUD de canciones con validación estricta.</li>
<li>Endpoints admin con acceso a todas las canciones y filtros adicionales.</li>
<li>Bloqueo/desbloqueo que actualizan estado y dejan registro de auditoría (CatalogState).</li>
<li>Incremento de reproducciones y consultas de apariciones y últimos lanzamientos por artista.</li>
<li>Filtrado por parámetros (genre, artistId, title, region, status, dateFrom/dateTo).</li>
<li>Pruebas y mantenimiento</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guía"><a class="header" href="#guía">Guía</a></h1>
<p>Acá vamos a ir poniendo como instalarlo, etc</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="manual-para-admins---backoffice"><a class="header" href="#manual-para-admins---backoffice">Manual para admins - backoffice</a></h1>
<p>En este archivo se va a explicar un poco del backoffice de melodia. El objetivo es que sea una guía para administradores de la app</p>
<hr />
<h2 id="contenido"><a class="header" href="#contenido">Contenido</a></h2>
<ol>
<li><a href="manual_admin.html#login">Login</a></li>
<li><a href="manual_admin.html#home">Panel principal (Home)</a></li>
<li><a href="manual_admin.html#usuarios">Lista de usuarios</a></li>
<li><a href="manual_admin.html#acciones-usuarios">Acciones sobre usuarios</a></li>
<li><a href="manual_admin.html#perfil-usuario">Perfil de usuario</a></li>
<li><a href="manual_admin.html#catalogo">Catálogo</a></li>
<li><a href="manual_admin.html#acciones-catalogo">Acciones del catálogo</a></li>
<li><a href="manual_admin.html#detalle-cancion">Detalle de canción</a></li>
<li><a href="manual_admin.html#auditoria">Auditoría</a></li>
<li><a href="manual_admin.html#metricas-coleccion">Métricas - Colecciones</a></li>
<li><a href="manual_admin.html#metricas-cancion">Métricas - Canciones</a></li>
<li><a href="manual_admin.html#metricas-usuarios">Métricas - Usuarios</a></li>
<li><a href="manual_admin.html#metricas-artistas">Métricas - Artistas (vista general)</a></li>
<li><a href="manual_admin.html#metricas-artista">Métricas - Artista (detalle)</a></li>
</ol>
<hr />
<p><a id="login"></a></p>
<h2 id="1---login"><a class="header" href="#1---login">1 - Login</a></h2>
<p>Para empezar, tenemos la pantalla de login. Simplemente hay que introducir las credenciales para entrar.</p>
<p><img src="./img_admin/login1.png" alt="1 - Login" /></p>
<hr />
<p><a id="home"></a></p>
<h2 id="2---panel-principal-home"><a class="header" href="#2---panel-principal-home">2 - Panel principal (Home)</a></h2>
<p>Al entrar a la aplicación se redirige al home, donde los datos importantes se acceden a traves del navbar</p>
<p><img src="./img_admin/home2.png" alt="2 - Home" /></p>
<hr />
<p><a id="usuarios"></a></p>
<h2 id="3---lista-de-usuarios"><a class="header" href="#3---lista-de-usuarios">3 - Lista de usuarios</a></h2>
<p>En el primer link de Usuarios, se lleva a la página con un listado con todos los usuarios y datos principales de estos. Se pueden seleccionar para ver un detalle o dar a los 3 puntos para tomar acciones</p>
<p><img src="./img_admin/usuarios3.png" alt="3 - Usuarios" /></p>
<hr />
<p><a id="acciones-usuarios"></a></p>
<h2 id="4---acciones-sobre-usuarios"><a class="header" href="#4---acciones-sobre-usuarios">4 - Acciones sobre usuarios</a></h2>
<p>Aca podemos ver las acciones que se pueden tomar sobre un usuario, siendo estas Cambiar su rol al de un artista, elimnarlo o desactivarlo para que no pueda loguearse en la app</p>
<p><img src="./img_admin/acciones_usuarios4.png" alt="4 - Acciones sobre usuarios" /></p>
<hr />
<p><a id="perfil-usuario"></a></p>
<h2 id="5---perfil-de-usuario"><a class="header" href="#5---perfil-de-usuario">5 - Perfil de usuario</a></h2>
<p>Al hacer click en un usuario, accedemos a su detalle con un poco de información adicional sobre este</p>
<p><img src="./img_admin/perfil_usuario5.png" alt="5 - Perfil de usuario" /></p>
<hr />
<p><a id="catalogo"></a></p>
<h2 id="6---catálogo"><a class="header" href="#6---catálogo">6 - Catálogo</a></h2>
<p>Luego, en la otra pestaña de catálogo tenemos un listado con canciones y colecciones, donde se puede buscar por el nombre, filtrar por tipo, estado, fecha y region</p>
<p><img src="./img_admin/catalogo6.png" alt="6 - Catálogo" /></p>
<hr />
<p><a id="acciones-catalogo"></a></p>
<h2 id="7---acciones-del-catálogo"><a class="header" href="#7---acciones-del-catálogo">7 - Acciones del catálogo</a></h2>
<p>Sobre cada elemento del catálogo se pueden tomar multiples acciones, como ver el detalle, las métricas, editarla, bloquearla o eliminarla</p>
<p><img src="./img_admin/acciones_catalogo7.png" alt="7 - Acciones del catálogo" /></p>
<hr />
<p><a id="detalle-cancion"></a></p>
<h2 id="8---detalle-de-canción"><a class="header" href="#8---detalle-de-canción">8 - Detalle de canción</a></h2>
<p>Al ver el detalle de una canción vemos mas información sobre esta y adicionalmente podemos escuchar el audio asociado</p>
<p><img src="./img_admin/cancion8.png" alt="8 - Detalle de canción" /></p>
<hr />
<p><a id="auditoria"></a></p>
<h2 id="9---auditoría"><a class="header" href="#9---auditoría">9 - Auditoría</a></h2>
<p>Un punto importante es la auditoría, aca vemos un historico de los cambios que se fueron efectuando sobre ese lanzamiento</p>
<p><img src="./img_admin/auditoria9.png" alt="9 - Auditoría" /></p>
<hr />
<p><a id="metricas-coleccion"></a></p>
<h2 id="10---métricas---colecciones"><a class="header" href="#10---métricas---colecciones">10 - Métricas - Colecciones</a></h2>
<p>Otra acción importante para ver son las métricas, ya que hay multiples KPIs que son de interes, como pueden ser las canciones de la colección, cuantas reproducciones tiene en total y el promedio</p>
<p><img src="./img_admin/metricas_coleccion10.png" alt="10 - Métricas Colección" /></p>
<hr />
<p><a id="metricas-cancion"></a></p>
<h2 id="11---métricas---canciones"><a class="header" href="#11---métricas---canciones">11 - Métricas - Canciones</a></h2>
<p>Al hacer click en una de las barras de una colección tambien se puede acceder directamente a las métricas de una canción</p>
<p><img src="./img_admin/metricas_cancion11.png" alt="11 - Métricas Canción" /></p>
<hr />
<p><a id="metricas-usuarios"></a></p>
<h2 id="12---métricas---usuarios"><a class="header" href="#12---métricas---usuarios">12 - Métricas - Usuarios</a></h2>
<p>En el próximo apartado de métricas de usuarios, tenemos datos relevantes como la retención de los usuarios (si es que tomaron acciones hace poco tiempo y tienen datos en su historial de reproducción), los usuarios nuevos que se crearon y los activos, ademas de la distribución por región. Todos los datos se pueden exportar en un csv para su futuro análisis</p>
<p><img src="./img_admin/metricas_usuarios12.png" alt="12 - Métricas Usuarios" /></p>
<hr />
<p><a id="metricas-artistas"></a></p>
<h2 id="13---métricas---artistas-vista-general"><a class="header" href="#13---métricas---artistas-vista-general">13 - Métricas - Artistas (vista general)</a></h2>
<p>En el último apartado, tenemos las métricas de artistas, donde se listan los artistas por su nombre artístico si es que cuentan con este, si no por el de usuario.</p>
<p><img src="./img_admin/metricas_artistas13.png" alt="13 - Métricas Artistas" /></p>
<hr />
<p><a id="metricas-artista"></a></p>
<h2 id="14---métricas---artista-detalle"><a class="header" href="#14---métricas---artista-detalle">14 - Métricas - Artista (detalle)</a></h2>
<p>Al hacer click en un artista podemos acceder a su detalle y ver métricas de este, como seguidores, cuantos oyentes tuvo en el mes, de donde eran y demas datos de interes para el negocio</p>
<p><img src="./img_admin/metricas_artista14.png" alt="14 - Métricas Artista" /></p>
<hr />
<h2 id="agradecimientos-finales"><a class="header" href="#agradecimientos-finales">Agradecimientos finales</a></h2>
<p>El equipo de Melodia agradece su atención al leer este documento, y esperamos que sea un gran administrador de nuestra aplicación!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
